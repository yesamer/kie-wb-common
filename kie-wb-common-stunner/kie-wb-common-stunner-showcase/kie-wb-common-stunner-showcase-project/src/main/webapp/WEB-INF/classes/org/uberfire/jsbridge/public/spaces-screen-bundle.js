!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("appformer-js")):"function"==typeof define&&define.amd?define("WorkbenchScreens",["react","appformer-js"],t):"object"==typeof exports?exports.WorkbenchScreens=t(require("react"),require("appformer-js")):e.WorkbenchScreens=t(e.React,e.AppFormer)}(window,function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n._fqcn=t.__fqcn(),n}return r(t,e),t.__fqcn=function(){return"org.uberfire.workbench.events.NotificationEvent$NotificationType"},t.values=function(){return[t.DEFAULT,t.ERROR,t.SUCCESS,t.INFO,t.WARNING]},t.DEFAULT=new t("DEFAULT"),t.ERROR=new t("ERROR"),t.SUCCESS=new t("SUCCESS"),t.INFO=new t("INFO"),t.WARNING=new t("WARNING"),t}(n(1).JavaEnum);t.NotificationType=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(t){this._fqcn=e.__fqcn(),this.notification=void 0,this.type=void 0,this.isSingleton=void 0,this.initialTopOffset=void 0,Object.assign(this,t)}return e.__fqcn=function(){return"org.uberfire.workbench.events.NotificationEvent"},e}();t.NotificationEvent=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.closeWhenClickingOverlay=function(e){e.target===e.currentTarget&&this.props.onClose()},t.prototype.render=function(){var e=this;return o.createElement("div",{onClick:function(t){return e.closeWhenClickingOverlay(t)},style:{position:"fixed",width:"100%",height:"100%",top:0,left:0,right:0,bottom:0,margin:"auto",backgroundColor:"rgba(0,0,0, 0.5)",zIndex:10}},o.createElement("div",{style:{position:"absolute",left:"25%",right:"25%",top:"25%",bottom:"75%",margin:"auto"}},this.props.children))},t}(o.Component);t.Popup=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchIsValidGroupIdName=function(e){return fetch("rest/spacesScreen/spaces/validGroupId?groupId="+e,{credentials:"same-origin"}).then(function(e){return e.json()})},t.fetchIsDuplicatedSpaceName=function(e){return fetch("rest/spacesScreen/spaces/"+e,{credentials:"same-origin"}).then(function(e){return 200===e.status})},t.fetchSpaces=function(){return fetch("rest/spacesScreen/spaces",{credentials:"same-origin"}).then(function(e){return e.json()})},t.createSpace=function(e){return fetch("rest/spacesScreen/spaces",{credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1),a=n(4);t.LoadingPopup=function(){return r.createElement(a.Popup,{onClose:function(){}},r.createElement("div",{className:"well",style:{width:"300px",float:"none",margin:"auto",textAlign:"center"}},r.createElement("div",{className:"spinner spinner-lg"}),r.createElement("span",null,o.translate("Loading",[]))))}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,c)}s((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),c=n(1),s=n(5),l=n(4),u=n(3),p=n(2),f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={name:"",description:"",errorMessages:[],displayedErrorMessages:[]},n}return r(t,e),t.prototype.add=function(){return o(this,void 0,void 0,function(){var e,t,n,r,o=this;return a(this,function(a){return e={name:this.state.name,description:this.state.description,groupId:"com."+this.state.name.toLowerCase()},t=Promise.resolve().then(function(){return e.name&&""!==e.name.trim()?Promise.resolve():(o.addErrorMessage(c.translate("EmptyFieldValidation",["Name"])),Promise.reject())}),n=Promise.resolve().then(function(){return s.fetchIsDuplicatedSpaceName(e.name)}).then(function(e){return e?(o.addErrorMessage(c.translate("DuplicatedOrganizationalUnitValidation",[c.translate("OrganizationalUnitDefaultAliasInSingular",[]).toLowerCase()])),Promise.reject()):Promise.resolve()}),r=Promise.resolve(!0).then(function(){return s.fetchIsValidGroupIdName(e.groupId)}).then(function(e){return e?Promise.resolve():(o.addErrorMessage(c.translate("InvalidSpaceName",[])),Promise.reject())}),this.setState({errorMessages:[]},function(){return Promise.resolve().then(function(){return Promise.all([t,n,r])}).then(function(){return s.createSpace(e)}).then(function(e){return c.fireEvent(new u.NotificationEvent({type:p.NotificationType.SUCCESS,notification:c.translate("OrganizationalUnitSaveSuccess",[c.translate("OrganizationalUnitDefaultAliasInSingular",[]).toLowerCase()])})),o.props.onClose()}).catch(function(){return o.setState(function(e){return{displayedErrorMessages:e.errorMessages}})})}),[2]})})},t.prototype.addErrorMessage=function(e){this.setState(function(t){return{errorMessages:t.errorMessages.concat([e])}})},t.prototype.render=function(){var e=this;return i.createElement(i.Fragment,null,i.createElement(l.Popup,{onClose:function(){return e.props.onClose()}},i.createElement("div",{className:"modal-content"},i.createElement("div",{className:"modal-header"},i.createElement("button",{type:"button",className:"close","data-dismiss":"modal",onClick:function(){return e.props.onClose()}},"Ã—"),i.createElement("h4",{className:"modal-title"},"Add Space")),i.createElement("div",{className:"modal-body"},this.state.displayedErrorMessages.map(function(e){return i.createElement("div",{key:e,className:"alert alert-danger alert-dismissable"},i.createElement("span",{className:"pficon pficon-error-circle-o"}),i.createElement("span",null,e))}),i.createElement("label",{className:"form-control-label required"},"Name"),i.createElement("div",{className:"form-group"},i.createElement("input",{type:"text",className:"form-control",onInput:function(t){return e.setState({name:t.target.value})}})),i.createElement("label",{className:"form-control-label"},"Description"),i.createElement("div",{className:"form-group"},i.createElement("input",{type:"text",className:"form-control",onInput:function(t){return e.setState({description:t.target.value})}}))),i.createElement("div",{className:"modal-footer"},i.createElement("button",{className:"btn btn-default",onClick:function(){return e.props.onClose()}},c.translate("Cancel",[])),i.createElement("button",{className:"btn btn-primary",onClick:function(){return e.add()}},c.translate("Add",[]))))))},t}(i.Component);t.NewSpacePopup=f},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(1),i=n(5),c=n(7),s=n(6),l=n(3),u=n(2),p=a.LibraryPlaces,f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={spaces:[],newSpacePopupOpen:!1,loading:!1},n.props.exposing(function(){return n}),n}return r(t,e),t.prototype.goToSpace=function(e){return e.deleted?(a.fireEvent(new l.NotificationEvent({type:u.NotificationType.WARNING,notification:a.translate("OrganizationalUnitDeletedCannotBeOpened",[a.translate("OrganizationalUnitDefaultAliasInSingular",[]).toLowerCase()])})),Promise.resolve()):this.showLoadingPopupWhile(p.goToSpace(e.name))},t.prototype.canCreateSpace=function(){return p.canCreateSpace()},t.prototype.openNewSpacePopup=function(){this.canCreateSpace()&&this.setState({newSpacePopupOpen:!0})},t.prototype.closeNewSpacePopup=function(){this.setState({newSpacePopupOpen:!1})},t.prototype.refreshSpaces=function(){var e=this;this.showLoadingPopupWhile(i.fetchSpaces()).then(function(t){return e.setState({spaces:t})})},t.prototype.componentDidMount=function(){this.refreshSpaces()},t.prototype.showLoadingPopupWhile=function(e){var t=this;return this.setState({loading:!0},function(){return e.then(function(){t.setState({loading:!1})}).catch(function(e){t.setState({loading:!1})})}),e},t.prototype.render=function(){var e=this;return o.createElement(o.Fragment,null,this.state.loading&&o.createElement(s.LoadingPopup,null),this.state.newSpacePopupOpen&&o.createElement(c.NewSpacePopup,{onClose:function(){return e.closeNewSpacePopup()}}),this.state.spaces.length<=0&&o.createElement(d,{onAddSpace:function(){return e.openNewSpacePopup()},canCreateSpace:function(){return e.canCreateSpace()}}),this.state.spaces.length>0&&o.createElement("div",{className:"library container-fluid"},o.createElement("div",{className:"row page-content-kie"},o.createElement("div",{className:"toolbar-pf"},o.createElement("div",{className:"toolbar-pf-actions"},o.createElement("div",{className:"toolbar-data-title-kie"},"Spaces"),o.createElement("div",{className:"btn-group toolbar-btn-group-kie"},this.canCreateSpace()&&o.createElement("button",{className:"btn btn-primary",onClick:function(){return e.openNewSpacePopup()}},a.translate("CreateOrganizationalUnit",[a.translate("OrganizationalUnitDefaultAliasInSingular",[])]))))),o.createElement("div",{className:"container-fluid container-cards-pf"},o.createElement("div",{className:"row row-cards-pf"},this.state.spaces.map(function(t){return o.createElement(m,{key:t.name,space:t,onSelect:function(){return e.goToSpace(t)}})}))))))},t}(o.Component);function d(e){return o.createElement("div",{className:"library"},o.createElement("div",{className:"col-sm-12 blank-slate-pf"},o.createElement("div",{className:"blank-slate-pf-icon"},o.createElement("span",{className:"pficon pficon pficon-add-circle-o"})),o.createElement("h1",null,a.translate("NothingHere",[])),o.createElement("p",null,a.translate("NoOrganizationalUnits",[a.translate("OrganizationalUnitDefaultAliasInPlural",[]),a.translate("OrganizationalUnitDefaultAliasInSingular",[])])),o.createElement("div",{className:"blank-slate-pf-main-action"},e.canCreateSpace()&&o.createElement("button",{className:"btn btn-primary btn-lg",onClick:function(){return e.onAddSpace()}},a.translate("CreateOrganizationalUnit",[a.translate("OrganizationalUnitDefaultAliasInSingular",[])])))))}function m(e){return o.createElement(o.Fragment,null,o.createElement("div",{title:e.space.description,className:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},o.createElement("div",{className:"card-pf card-pf-view card-pf-view-select card-pf-view-single-select",onClick:function(){return e.onSelect()}},o.createElement("div",{className:"card-pf-body"},o.createElement("div",{className:"card-pf-body-title"},o.createElement("div",{className:"card-pf-title",style:{display:"flex"}},o.createElement("h2",{className:"card-pf-title"}," ",e.space.name," "),e.space.deleted&&o.createElement("span",{className:"pficon-warning-triangle-o",style:{marginLeft:"10px"},title:a.translate("OrganizationalUnitDeletedCannotBeOpened",[a.translate("OrganizationalUnitDefaultAliasInSingular",[]).toLowerCase()])})),o.createElement("h5",null,e.space.description),o.createElement("h5",{className:"card-pf-contributors"},a.translate("NumberOfContributors",[e.space.contributors.length.toString()]))),o.createElement("div",{className:"right"},o.createElement("span",{className:"card-pf-icon-circle"},e.space.repositories.length))))))}t.SpacesScreen=f,t.EmptySpacesScreen=d,t.Tile=m},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=n(0),i=n(8),c=function(e){function t(){var t=e.call(this,"LibraryOrganizationalUnitsScreen")||this;return t.af_isReact=!0,t.af_componentTitle="Spaces screen",t.af_subscriptions=new Map([["org.guvnor.structure.organizationalunit.NewOrganizationalUnitEvent",function(e){return t.self.refreshSpaces()}],["org.guvnor.structure.organizationalunit.RemoveOrganizationalUnitEvent",function(e){return t.self.refreshSpaces()}],["org.kie.workbench.common.screens.library.api.sync.ClusterLibraryEvent",function(e){return t.self.refreshSpaces()}],["org.guvnor.common.services.project.events.NewProjectEvent",function(e){return t.self.refreshSpaces()}],["org.guvnor.structure.repositories.RepositoryRemovedEvent",function(e){return t.self.refreshSpaces()}],["org.guvnor.structure.contributors.SpaceContributorsUpdatedEvent",function(e){return t.self.refreshSpaces()}]]),t}return r(t,e),t.prototype.af_onOpen=function(){this.self.refreshSpaces()},t.prototype.af_componentRoot=function(){var e=this;return a.createElement(i.SpacesScreen,{exposing:function(t){return e.self=t()}})},t}(o.Screen);t.SpacesScreenAppFormerComponent=c,o.register(new c)}])});